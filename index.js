var TelegramBot = require('node-telegram-bot-api');
const token = require('./tgapi_token');

process.env.TZ = 'Europe/Kiev';

var botOptions = {
    polling: true
};
var bot = new TelegramBot(token, botOptions);

bot.getMe().then(function(me)
{
    console.log('Hello! My name is %s!', me.first_name);
    console.log('My id is %s.', me.id);
    console.log('And my username is @%s.', me.username);
});

let curriculumObject = {
    "16-4-2019": "\n15:10 ===> \nĞŸĞ°Ñ€Ğ° 5:  Ğ‘Ğ°Ğ·Ğ¸ Ğ´Ğ°Ğ½Ğ¸Ñ… (211)-ĞšÑ€Ğ°ÑĞ½Ğ¾Ñ‰Ğ¾Ğº Ğ’.Ğœ. (Ğ›); \n16:40 ===> \nĞŸĞ°Ñ€Ğ° 6:  ĞœĞµĞ½ĞµĞ´Ğ¶Ğ¼ĞµĞ½Ñ‚ Ğ¿Ñ€Ğ¾ĞµĞºÑ‚Ñ–Ğ² Ğ¿Ñ€Ğ¾Ğ³Ñ€Ğ°Ğ¼Ğ½Ğ¾Ğ³Ğ¾ Ğ·Ğ°Ğ±ĞµĞ·Ğ¿ĞµÑ‡ĞµĞ½Ğ½Ñ (318)-Ğ¥Ğ»ĞµĞ²Ğ½Ğ¸Ğ¹ ĞĞ½Ğ´Ñ€Ñ–Ğ¹ ĞĞ»ĞµĞºÑĞ°Ğ½Ğ´Ñ€Ğ¾Ğ²Ğ¸Ñ‡ (Ğ›)", "17-4-2019": "\n13-40 ===> \nĞŸĞ°Ñ€Ğ° 4:  Ğ†Ğ½Ğ¶ĞµĞ½ĞµÑ€Ñ–Ñ Ğ¿Ñ€Ğ¾Ğ³Ñ€Ğ°Ğ¼Ğ½Ğ¾Ğ³Ğ¾ Ğ·Ğ°Ğ±ĞµĞ·Ğ¿ĞµÑ‡ĞµĞ½Ğ½Ñ (209)-Ğ‘Ğ¾Ğ¹ĞºĞ¾ Ğ®.ĞŸ. (Ğ›); \n15-10 ===> \nĞŸĞ°Ñ€Ğ° 5:  ĞĞ±'Ñ”ĞºÑ‚Ğ½Ğ¾-Ğ¾Ñ€Ñ–Ñ”Ğ½Ñ‚Ğ¾Ğ²Ğ°Ğ½Ğµ Ğ¿Ñ€Ğ¾Ğ³Ñ€Ğ°Ğ¼ÑƒĞ²Ğ°Ğ½Ğ½Ñ (209)-Ğ”ÑƒÑ…Ğ½Ğ¾Ğ²ÑÑŒĞºĞ° Ğš.Ğš. (Ğ›); \n16-40 ===> \nĞŸĞ°Ñ€Ğ° 6:  ĞœĞµĞ½ĞµĞ´Ğ¶Ğ¼ĞµĞ½Ñ‚ Ğ¿Ñ€Ğ¾ĞµĞºÑ‚Ñ–Ğ² Ğ¿Ñ€Ğ¾Ğ³Ñ€Ğ°Ğ¼Ğ½Ğ¾Ğ³Ğ¾ Ğ·Ğ°Ğ±ĞµĞ·Ğ¿ĞµÑ‡ĞµĞ½Ğ½Ñ (201)-Ğ¨ĞµĞ»ĞµÑÑ‚ Ğ¢ĞµÑ‚ÑĞ½Ğ° ĞœĞ¸ĞºĞ¾Ğ»Ğ°Ñ—Ğ²Ğ½Ğ° (Ğ») Ğ¿Ñ–Ğ´Ğ³Ñ€ÑƒĞ¿Ğ° 2",
    "18-4-2019": "\n13-40 ===> \nĞŸĞ°Ñ€Ğ° 4:  ĞĞ±'Ñ”ĞºÑ‚Ğ½Ğ¾-Ğ¾Ñ€Ñ–Ñ”Ğ½Ñ‚Ğ¾Ğ²Ğ°Ğ½Ğµ Ğ¿Ñ€Ğ¾Ğ³Ñ€Ğ°Ğ¼ÑƒĞ²Ğ°Ğ½Ğ½Ñ (311)-Ğ”ÑƒÑ…Ğ½Ğ¾Ğ²ÑÑŒĞºĞ° Ğš.Ğš. (Ğ») Ğ¿Ñ–Ğ´Ğ³Ñ€ÑƒĞ¿Ğ° 1; \n15-10 ===> \nĞŸĞ°Ñ€Ğ° 5:  ĞĞ±'Ñ”ĞºÑ‚Ğ½Ğ¾-Ğ¾Ñ€Ñ–Ñ”Ğ½Ñ‚Ğ¾Ğ²Ğ°Ğ½Ğµ Ğ¿Ñ€Ğ¾Ğ³Ñ€Ğ°Ğ¼ÑƒĞ²Ğ°Ğ½Ğ½Ñ (201)-Ğ”ÑƒÑ…Ğ½Ğ¾Ğ²ÑÑŒĞºĞ° Ğš.Ğš. (Ğ») Ğ¿Ñ–Ğ´Ğ³Ñ€ÑƒĞ¿Ğ° 2; \n15-10 ===> \nĞŸĞ°Ñ€Ğ° 5:  ĞœĞµĞ½ĞµĞ´Ğ¶Ğ¼ĞµĞ½Ñ‚ Ğ¿Ñ€Ğ¾ĞµĞºÑ‚Ñ–Ğ² Ğ¿Ñ€Ğ¾Ğ³Ñ€Ğ°Ğ¼Ğ½Ğ¾Ğ³Ğ¾ Ğ·Ğ°Ğ±ĞµĞ·Ğ¿ĞµÑ‡ĞµĞ½Ğ½Ñ (202)-Ğ¥Ğ»ĞµĞ²Ğ½Ğ¸Ğ¹ ĞĞ½Ğ´Ñ€Ñ–Ğ¹ ĞĞ»ĞµĞºÑĞ°Ğ½Ğ´Ñ€Ğ¾Ğ²Ğ¸Ñ‡ (Ğ») Ğ¿Ñ–Ğ´Ğ³Ñ€ÑƒĞ¿Ğ° 1; \n16-40 ===> \nĞŸĞ°Ñ€Ğ° 6:  Ğ†Ğ½Ñ„Ğ¾Ñ€Ğ¼Ğ°Ñ†Ñ–Ğ¹Ğ½Ñ– ÑĞ¸ÑÑ‚ĞµĞ¼Ğ¸ Ñ– Ñ‚ĞµÑ…Ğ½Ğ¾Ğ»Ğ¾Ğ³Ñ–Ñ— Ğ½Ğ° Ğ¿Ñ–Ğ´Ğ¿Ñ€Ğ¸Ñ”Ğ¼ÑÑ‚Ğ²Ğ°Ñ… (209)-ĞŸĞ»ĞµÑĞºĞ°Ñ‡ Ğ’.Ğ›. (Ğ›)",
    "19-4-2019": "\n13-40 ===> \nĞŸĞ°Ñ€Ğ° 4:  ĞĞ±'Ñ”ĞºÑ‚Ğ½Ğ¾-Ğ¾Ñ€Ñ–Ñ”Ğ½Ñ‚Ğ¾Ğ²Ğ°Ğ½Ğµ Ğ¿Ñ€Ğ¾Ğ³Ñ€Ğ°Ğ¼ÑƒĞ²Ğ°Ğ½Ğ½Ñ (202)-Ğ”ÑƒÑ…Ğ½Ğ¾Ğ²ÑÑŒĞºĞ° Ğš.Ğš. (Ğ») Ğ¿Ñ–Ğ´Ğ³Ñ€ÑƒĞ¿Ğ° 1; \nĞŸĞ°Ñ€Ğ° 4:  Ğ‘Ğ°Ğ·Ğ¸ Ğ´Ğ°Ğ½Ğ¸Ñ… (215)-ĞšÑ€Ğ°ÑĞ½Ğ¾Ñ‰Ğ¾Ğº Ğ’.Ğœ. (Ğ») Ğ¿Ñ–Ğ´Ğ³Ñ€ÑƒĞ¿Ğ° 2; \n15-10 ===> \nĞŸĞ°Ñ€Ğ° 5:  Ğ†Ğ½Ñ„Ğ¾Ñ€Ğ¼Ğ°Ñ†Ñ–Ğ¹Ğ½Ñ– ÑĞ¸ÑÑ‚ĞµĞ¼Ğ¸ Ñ– Ñ‚ĞµÑ…Ğ½Ğ¾Ğ»Ğ¾Ğ³Ñ–Ñ— Ğ½Ğ° Ğ¿Ñ–Ğ´Ğ¿Ñ€Ğ¸Ñ”Ğ¼ÑÑ‚Ğ²Ğ°Ñ… (202)-ĞšÑ€Ğ°ÑĞ½Ğ¾Ñ‰Ğ¾Ğº Ğ’.Ğœ. (Ğ») Ğ¿Ñ–Ğ´Ğ³Ñ€ÑƒĞ¿Ğ° 1; \n15-10 ===> \nĞŸĞ°Ñ€Ğ° 5:  Ğ‘ĞµĞ·Ğ¿ĞµĞºĞ° Ğ¼ĞµÑ€ĞµĞ¶ Ñ– ĞºĞ¾Ğ¼Ğ¿'ÑÑ‚ĞµÑ€Ğ½Ğ¸Ñ… ÑĞ¸ÑÑ‚ĞµĞ¼ (217)-Ğ¢Ñ–Ñ‚Ğ¾Ğ²Ğ° Ğ.Ğ®. (Ğ») Ğ¿Ñ–Ğ´Ğ³Ñ€ÑƒĞ¿Ğ° 2; \n16-40 ===> \nĞŸĞ°Ñ€Ğ° 6:  ĞĞ±'Ñ”ĞºÑ‚Ğ½Ğ¾-Ğ¾Ñ€Ñ–Ñ”Ğ½Ñ‚Ğ¾Ğ²Ğ°Ğ½Ğµ Ğ¿Ñ€Ğ¾Ğ³Ñ€Ğ°Ğ¼ÑƒĞ²Ğ°Ğ½Ğ½Ñ (306)-Ğ”ÑƒÑ…Ğ½Ğ¾Ğ²ÑÑŒĞºĞ° Ğš.Ğš. (Ğ») Ğ¿Ñ–Ğ´Ğ³Ñ€ÑƒĞ¿Ğ° 2; \n16-40 ===> \nĞŸĞ°Ñ€Ğ° 6:  Ğ‘ĞµĞ·Ğ¿ĞµĞºĞ° Ğ¼ĞµÑ€ĞµĞ¶ Ñ– ĞºĞ¾Ğ¼Ğ¿'ÑÑ‚ĞµÑ€Ğ½Ğ¸Ñ… ÑĞ¸ÑÑ‚ĞµĞ¼ (318)-Ğ¢Ñ–Ñ‚Ğ¾Ğ²Ğ° Ğ.Ğ®. (Ğ») Ğ¿Ñ–Ğ´Ğ³Ñ€ÑƒĞ¿Ğ° 1",
    "23-4-2019": "\n13-40 ===> \nĞŸĞ°Ñ€Ğ° 4:  ĞŸÑ€Ğ¸ĞºĞ»Ğ°Ğ´Ğ½Ğµ Ğ¿Ñ€Ğ¾Ğ³Ñ€Ğ°Ğ¼Ğ½Ğµ Ğ·Ğ°Ğ±ĞµĞ·Ğ¿ĞµÑ‡ĞµĞ½Ğ½Ñ (217)-Ğ”Ğ¾Ğ¼Ñ€Ğ°Ñ‡ĞµĞ² Ğ’.Ğœ. (ĞŸ); \n15-10 ===> \nĞŸĞ°Ñ€Ğ° 5:  Ğ‘Ğ°Ğ·Ğ¸ Ğ´Ğ°Ğ½Ğ¸Ñ… (307)-ĞšÑ€Ğ°ÑĞ½Ğ¾Ñ‰Ğ¾Ğº Ğ’.Ğœ. (Ğ») Ğ¿Ñ–Ğ´Ğ³Ñ€ÑƒĞ¿Ğ° 1; \n15-10 ===> \nĞŸĞ°Ñ€Ğ° 5:  ĞœĞµĞ½ĞµĞ´Ğ¶Ğ¼ĞµĞ½Ñ‚ Ğ¿Ñ€Ğ¾ĞµĞºÑ‚Ñ–Ğ² Ğ¿Ñ€Ğ¾Ğ³Ñ€Ğ°Ğ¼Ğ½Ğ¾Ğ³Ğ¾ Ğ·Ğ°Ğ±ĞµĞ·Ğ¿ĞµÑ‡ĞµĞ½Ğ½Ñ (202)-Ğ¨ĞµĞ»ĞµÑÑ‚ Ğ¢ĞµÑ‚ÑĞ½Ğ° ĞœĞ¸ĞºĞ¾Ğ»Ğ°Ñ—Ğ²Ğ½Ğ° (Ğ») Ğ¿Ñ–Ğ´Ğ³Ñ€ÑƒĞ¿Ğ° 2; \n16-40 ===> \nĞŸĞ°Ñ€Ğ° 6:  ĞœĞµĞ½ĞµĞ´Ğ¶Ğ¼ĞµĞ½Ñ‚ Ğ¿Ñ€Ğ¾ĞµĞºÑ‚Ñ–Ğ² Ğ¿Ñ€Ğ¾Ğ³Ñ€Ğ°Ğ¼Ğ½Ğ¾Ğ³Ğ¾ Ğ·Ğ°Ğ±ĞµĞ·Ğ¿ĞµÑ‡ĞµĞ½Ğ½Ñ (318)-Ğ¥Ğ»ĞµĞ²Ğ½Ğ¸Ğ¹ ĞĞ½Ğ´Ñ€Ñ–Ğ¹ ĞĞ»ĞµĞºÑĞ°Ğ½Ğ´Ñ€Ğ¾Ğ²Ğ¸Ñ‡ (Ğ›)",
    "24-4-2019": "\n13-40 ===> \nĞŸĞ°Ñ€Ğ° 4:  ĞĞ±'Ñ”ĞºÑ‚Ğ½Ğ¾-Ğ¾Ñ€Ñ–Ñ”Ğ½Ñ‚Ğ¾Ğ²Ğ°Ğ½Ğµ Ğ¿Ñ€Ğ¾Ğ³Ñ€Ğ°Ğ¼ÑƒĞ²Ğ°Ğ½Ğ½Ñ (211)-Ğ”ÑƒÑ…Ğ½Ğ¾Ğ²ÑÑŒĞºĞ° Ğš.Ğš. (Ğ›); \n15-10 ===> \nĞŸĞ°Ñ€Ğ° 5:  ĞŸÑ€Ğ¸ĞºĞ»Ğ°Ğ´Ğ½Ğµ Ğ¿Ñ€Ğ¾Ğ³Ñ€Ğ°Ğ¼Ğ½Ğµ Ğ·Ğ°Ğ±ĞµĞ·Ğ¿ĞµÑ‡ĞµĞ½Ğ½Ñ (209)-Ğ”Ğ¾Ğ¼Ñ€Ğ°Ñ‡ĞµĞ² Ğ’.Ğœ. (Ğ›); \n16-40 ===> \nĞŸĞ°Ñ€Ğ° 6:  ĞœĞµĞ½ĞµĞ´Ğ¶Ğ¼ĞµĞ½Ñ‚ Ğ¿Ñ€Ğ¾ĞµĞºÑ‚Ñ–Ğ² Ğ¿Ñ€Ğ¾Ğ³Ñ€Ğ°Ğ¼Ğ½Ğ¾Ğ³Ğ¾ Ğ·Ğ°Ğ±ĞµĞ·Ğ¿ĞµÑ‡ĞµĞ½Ğ½Ñ (208)-Ğ¥Ğ»ĞµĞ²Ğ½Ğ¸Ğ¹ ĞĞ½Ğ´Ñ€Ñ–Ğ¹ ĞĞ»ĞµĞºÑĞ°Ğ½Ğ´Ñ€Ğ¾Ğ²Ğ¸Ñ‡ (Ğ») Ğ¿Ñ–Ğ´Ğ³Ñ€ÑƒĞ¿Ğ° 1",
};

function getCurrentFormatedDate() {
    let now = new Date();
    let nowStr = now.getDate() + "-" + (now.getMonth() + 1) + "-" + now.getFullYear();
    return nowStr;
}

function getFormatedDate(date) {
    let now = date;
    let nowStr = now.getDate() + "-" + (now.getMonth() + 1) + "-" + now.getFullYear();
    return nowStr;
}

function sendMessageByBot(aChatId, aMessage)
{
    bot.sendMessage(aChatId, aMessage, { caption: 'I\'m a cute bot!' });
}

function sendPhotoByBot(aChatId, aPhoto) {
    bot.sendPhoto(aChatId, aPhoto);
}

bot.on('text', function(msg)
{
    var messageChatId = msg.chat.id;
    var messageText = msg.text;
    var messageDate = msg.date;
    var messageUsr = msg.from.username;

    if (messageText === '/curriculum') {
        if (curriculumObject[getCurrentFormatedDate()] != undefined) {
            sendMessageByBot(messageChatId, 'ğŸ‘¨â€ğŸ“The curriculum for todayğŸ‘©â€ğŸ“ :' + "\n" + curriculumObject[getCurrentFormatedDate()]);
        } else  {
            sendMessageByBot(messageChatId, 'There is no curriculum for today! âœ…');
        }
    } else if (messageText == '/tomorrow') {
        let now = new Date(), tomorrow = new Date();
        tomorrow.setDate(now.getDate() + 1);
        if (curriculumObject[getFormatedDate(tomorrow)] != undefined) {
            sendMessageByBot(messageChatId, 'ğŸ‘¨â€ğŸ“The curriculum for tomorrowğŸ‘©â€ğŸ“ :' + "\n" + curriculumObject[getFormatedDate(tomorrow)]);
        } else  {
            sendMessageByBot(messageChatId, 'There is no curriculum for tomorrow! âœ…');
        }
    }

    console.log(msg);
});
