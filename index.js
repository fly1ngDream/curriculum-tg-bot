var Promise = require("bluebird");
var TelegramBot = require('node-telegram-bot-api');

var token = '***REMOVED***';
var botOptions = {
    polling: true
};
var bot = new TelegramBot(token, botOptions);

bot.getMe().then(function(me)
{
    console.log('Hello! My name is %s!', me.first_name);
    console.log('My id is %s.', me.id);
    console.log('And my username is @%s.', me.username);
});

let curriculumObject = {
    "19-10-2018" : "\n13:40 ==> \n–ü–∞—Ä–∞ 4: –ö–æ–º–ø‚Äô—é—Ç–µ—Ä–Ω–∞ –≥—Ä–∞—Ñ—ñ–∫–∞ —Ç–∞ –º—É–ª—å—Ç–∏–º–µ–¥—ñ–∞ (101)-–ë–æ–π–∫–æ –Æ.–ü. (–ª) –ø—ñ–¥–≥—Ä—É–ø–∞ 1; \n13:40 ==> \n–ü–∞—Ä–∞ 4: –û–±‚Äô—î–∫—Ç–Ω–æ-–æ—Ä—ñ—î–Ω—Ç–æ–≤–∞–Ω–µ –ø—Ä–æ–≥—Ä–∞–º—É–≤–∞–Ω–Ω—è (307)- –î—É—Ö–Ω–æ–≤—Å—å–∫–∞ –ö.–ö. (–ª) –ø—ñ–¥–≥—Ä—É–ø–∞ 2; \n15:10 ==> \n–ü–∞—Ä–∞ 5: –ü—Ä–æ–µ–∫—Ç—É–≤–∞–Ω–Ω—è —Ç–∞ –∞–Ω–∞–ª—ñ–∑ –æ–±—á–∏—Å–ª—é–≤–∞–ª—å–Ω–∏—Ö –∞–ª–≥–æ—Ä–∏—Ç–º—ñ–≤ (217)-–î–æ–º—Ä–∞—á–µ–≤ –í.–ú. (–ü); \n16:40 ==> \n–ü–∞—Ä–∞ 6: –û–±‚Äô—î–∫—Ç–Ω–æ-–æ—Ä—ñ—î–Ω—Ç–æ–≤–∞–Ω–µ –ø—Ä–æ–≥—Ä–∞–º—É–≤–∞–Ω–Ω—è (307–ë)-–î—É—Ö–Ω–æ–≤—Å—å–∫–∞ –ö.–ö. (–ª) –ø—ñ–¥–≥—Ä—É–ø–∞ 2; \n16:40 ==> \n–ü–∞—Ä–∞ 6: –û–±‚Äô—î–∫—Ç–Ω–æ-–æ—Ä—ñ—î–Ω—Ç–æ–≤–∞–Ω–µ –ø—Ä–æ–≥—Ä–∞–º—É–≤–∞–Ω–Ω—è (307–ê)-–ì–∞–ª–∞—Ç–∞ –õ.–ü. (–ª) –ø—ñ–¥–≥—Ä—É–ø–∞ 1",
    "22-10-2018" : "\n12:10 ==> \n–ü–∞—Ä–∞ 3: –ö–æ–º–ø'—é—Ç–µ—Ä–Ω—ñ –º–µ—Ä–µ–∂—ñ (307)-–°–∞–π–∫–æ –í.–ì. (–ª) –ø—ñ–¥–≥—Ä—É–ø–∞ 2; \n13:40 ==> \n–ü–∞—Ä–∞ 4: –ö–æ–º–ø'—é—Ç–µ—Ä–Ω—ñ –º–µ—Ä–µ–∂—ñ (318)-–°–∞–π–∫–æ –í.–ì. (–õ); \n15:10 ==> \n–ü–∞—Ä–∞ 5: –û–±‚Äô—î–∫—Ç–Ω–æ-–æ—Ä—ñ—î–Ω—Ç–æ–≤–∞–Ω–µ –ø—Ä–æ–≥—Ä–∞–º—É–≤–∞–Ω–Ω—è (318)-–ö–æ—Ä–Ω—ñ—î–Ω–∫–æ –ë.–Ø. (–õ)",
    "23-10-2018" : "\n13:40 ==> \n–ü–∞—Ä–∞ 4: –ù–∞—É–∫–æ–≤–∏–π –æ–±—Ä–∞–∑ —Å–≤—ñ—Ç—É (217)-–í–∏—à–∏–≤–∞–Ω–∞ –Ü.–ì. (–õ); \n15:10 ==> \n–ü–∞—Ä–∞ 5: –ö–æ–º–ø‚Äô—é—Ç–µ—Ä–Ω–∞ –≥—Ä–∞—Ñ—ñ–∫–∞ —Ç–∞ –º—É–ª—å—Ç–∏–º–µ–¥—ñ–∞ (202)-–°–∞–π–∫–æ –í.–ì. (–õ)",
    "24-10-2018" : "\n13:40 ==> \n–ü–∞—Ä–∞ 4: –ü—Ä–æ–µ–∫—Ç—É–≤–∞–Ω–Ω—è —Ç–∞ –∞–Ω–∞–ª—ñ–∑ –æ–±—á–∏—Å–ª—é–≤–∞–ª—å–Ω–∏—Ö –∞–ª–≥–æ—Ä–∏—Ç–º—ñ–≤ (318)-–î–æ–º—Ä–∞—á–µ–≤ –í.–ú. (–õ); \n15:10 ==> \n–ü–∞—Ä–∞ 5: –£–∫—Ä–∞—ó–Ω—Å—å–∫–∞ —Ç–∞ –∑–∞—Ä—É–±—ñ–∂–Ω–∞ –∫—É–ª—å—Ç—É—Ä–∞ (217)-–û–º–µ–ª—å—á–µ–Ω–∫–æ –í.–Æ. (–õ)",
    "25-10-2018" : "\n13:40 ==> \n–ü–∞—Ä–∞ 4: –ö–æ–º–ø'—é—Ç–µ—Ä–Ω—ñ –º–µ—Ä–µ–∂—ñ (316)-–°–∞–π–∫–æ –í.–ì. (–ª) –ø—ñ–¥–≥—Ä—É–ø–∞ 1; \n13:40 ==> \n–ü–∞—Ä–∞ 4: –û–±‚Äô—î–∫—Ç–Ω–æ-–æ—Ä—ñ—î–Ω—Ç–æ–≤–∞–Ω–µ –ø—Ä–æ–≥—Ä–∞–º—É–≤–∞–Ω–Ω—è (213)-–î—É—Ö–Ω–æ–≤—Å—å–∫–∞ –ö.–ö. (–ª) –ø—ñ–¥–≥—Ä—É–ø–∞ 2; \n15:10 ==> \n–ü–∞—Ä–∞ 5: –£–∫—Ä–∞—ó–Ω—Å—å–∫–∞ —Ç–∞ –∑–∞—Ä—É–±—ñ–∂–Ω–∞ –∫—É–ª—å—Ç—É—Ä–∞ (217)-–û–º–µ–ª—å—á–µ–Ω–∫–æ –í.–Æ. (–°)",
    "26-10-2018" : "\n13:40 ==> \n–ü–∞—Ä–∞ 4: –ë–∞–∑–∏ –¥–∞–Ω–∏—Ö (202)-–ö—Ä–∞—Å–Ω–æ—â–æ–∫ –í.–ú. (–ª); \n15:10 ==> \n–ü–∞—Ä–∞ 5: –ö–æ–º–ø'—é—Ç–µ—Ä–Ω—ñ –º–µ—Ä–µ–∂—ñ (202)-–°–∞–π–∫–æ –í.–ì. (–ª) –ø—ñ–¥–≥—Ä—É–ø–∞ 1; \n15:10 ==> \n–ü–∞—Ä–∞ 5: –ö–æ–º–ø‚Äô—é—Ç–µ—Ä–Ω–∞ –≥—Ä–∞—Ñ—ñ–∫–∞ —Ç–∞ –º—É–ª—å—Ç–∏–º–µ–¥—ñ–∞ (101)-–ë–æ–π–∫–æ –Æ.–ü. (–ª) –ø—ñ–¥–≥—Ä—É–ø–∞ 2",
    "29-10-2018" : "\n12:10 ==> \n–ü–∞—Ä–∞ 3: –ö–æ–º–ø'—é—Ç–µ—Ä–Ω—ñ –º–µ—Ä–µ–∂—ñ (101)-–°–∞–π–∫–æ –í.–ì. (–ª) –ø—ñ–¥–≥—Ä—É–ø–∞ 2; \n13:40 ==> \n–ü–∞—Ä–∞ 4: –ö–æ–º–ø'—é—Ç–µ—Ä–Ω—ñ –º–µ—Ä–µ–∂—ñ (103)-–°–∞–π–∫–æ –í.–ì. (–õ); \n15:10 ==> \n–ü–∞—Ä–∞ 5: –û–±‚Äô—î–∫—Ç–Ω–æ-–æ—Ä—ñ—î–Ω—Ç–æ–≤–∞–Ω–µ –ø—Ä–æ–≥—Ä–∞–º—É–≤–∞–Ω–Ω—è (318)-–ö–æ—Ä–Ω—ñ—î–Ω–∫–æ –ë.–Ø. (–õ)",
    "30-10-2018" : "\n13:40 ==> \n–ü–∞—Ä–∞ 4: –ù–∞—É–∫–æ–≤–∏–π –æ–±—Ä–∞–∑ —Å–≤—ñ—Ç—É (102)-–í–∏—à–∏–≤–∞–Ω–∞ –Ü.–ì. (–õ); \n15:10 ==> \n–ü–∞—Ä–∞ 5: –û—Å–Ω–æ–≤–∏ –µ–∫–æ–ª–æ–≥—ñ—ó (102)-–ö–∞—Ä–ª–∞—â—É–∫ –°.–í. (–õ); \n16:40 ==> \n–ü–∞—Ä–∞ 6: –ë–∞–∑–∏ –¥–∞–Ω–∏—Ö (211)-–ö—Ä–∞—Å–Ω–æ—â–æ–∫ –í.–ú. (–õ)",
    "31-10-2018" : "\n13:40 ==> \n–ü–∞—Ä–∞ 4: –ü—Ä–æ–µ–∫—Ç—É–≤–∞–Ω–Ω—è —Ç–∞ –∞–Ω–∞–ª—ñ–∑ –æ–±—á–∏—Å–ª—é–≤–∞–ª—å–Ω–∏—Ö –∞–ª–≥–æ—Ä–∏—Ç–º—ñ–≤ (102)-–î–æ–º—Ä–∞—á–µ–≤ –í.–ú. (–õ); \n15:10 ==> \n–ü–∞—Ä–∞ 5: –£–∫—Ä–∞—ó–Ω—Å—å–∫–∞ —Ç–∞ –∑–∞—Ä—É–±—ñ–∂–Ω–∞ –∫—É–ª—å—Ç—É—Ä–∞ (102)-–û–º–µ–ª—å—á–µ–Ω–∫–æ –í.–Æ. (–õ)",
    "1-11-2018" : "\n15:10 ==> \n–ü–∞—Ä–∞ 5: –ü—Ä–æ–µ–∫—Ç—É–≤–∞–Ω–Ω—è —Ç–∞ –∞–Ω–∞–ª—ñ–∑ –æ–±—á–∏—Å–ª—é–≤–∞–ª—å–Ω–∏—Ö –∞–ª–≥–æ—Ä–∏—Ç–º—ñ–≤ (217)-–î–æ–º—Ä–∞—á–µ–≤ –í.–ú. (–ü); \n16:40 ==> \n–ü–∞—Ä–∞ 6: –ö–æ–º–ø‚Äô—é—Ç–µ—Ä–Ω–∞ –≥—Ä–∞—Ñ—ñ–∫–∞ —Ç–∞ –º—É–ª—å—Ç–∏–º–µ–¥—ñ–∞ (106)-–ë–æ–π–∫–æ –Æ.–ü. (–ª) –ø—ñ–¥–≥—Ä—É–ø–∞ 1; \n16:40 ==> \n–ü–∞—Ä–∞ 6: –û–±‚Äô—î–∫—Ç–Ω–æ-–æ—Ä—ñ—î–Ω—Ç–æ–≤–∞–Ω–µ –ø—Ä–æ–≥—Ä–∞–º—É–≤–∞–Ω–Ω—è (107)-–î—É—Ö–Ω–æ–≤—Å—å–∫–∞ –ö.–ö. (–ª) –ø—ñ–¥–≥—Ä—É–ø–∞ 2",
    "2-11-2018" : "\n13:40 ==> \n–ü–∞—Ä–∞ 4: –ë–∞–∑–∏ –¥–∞–Ω–∏—Ö (202)-–ö—Ä–∞—Å–Ω–æ—â–æ–∫ –í.–ú. (–ª); \n15:10 ==> \n–ü–∞—Ä–∞ 5: –ü—Ä–æ–µ–∫—Ç—É–≤–∞–Ω–Ω—è —Ç–∞ –∞–Ω–∞–ª—ñ–∑ –æ–±—á–∏—Å–ª—é–≤–∞–ª—å–Ω–∏—Ö –∞–ª–≥–æ—Ä–∏—Ç–º—ñ–≤ (217)-–î–æ–º—Ä–∞—á–µ–≤ –í.–ú. (–ü)",
    "5-11-2018" : "\n12:10 ==> \n–ü–∞—Ä–∞ 3: –ö–æ–º–ø'—é—Ç–µ—Ä–Ω—ñ –º–µ—Ä–µ–∂—ñ (101)-–°–∞–π–∫–æ –í.–ì. (–ª) –ø—ñ–¥–≥—Ä—É–ø–∞ 2; \n13:40 ==> \n–ü–∞—Ä–∞ 4: –ö–æ–º–ø'—é—Ç–µ—Ä–Ω—ñ –º–µ—Ä–µ–∂—ñ (103)-–°–∞–π–∫–æ –í.–ì. (–õ); \n15:10 ==> \n–ü–∞—Ä–∞ 5: –û–±‚Äô—î–∫—Ç–Ω–æ-–æ—Ä—ñ—î–Ω—Ç–æ–≤–∞–Ω–µ –ø—Ä–æ–≥—Ä–∞–º—É–≤–∞–Ω–Ω—è (318)-–ö–æ—Ä–Ω—ñ—î–Ω–∫–æ –ë.–Ø. (–õ); \n16:40 ==> \n–ü–∞—Ä–∞ 6: –û–±‚Äô—î–∫—Ç–Ω–æ-–æ—Ä—ñ—î–Ω—Ç–æ–≤–∞–Ω–µ –ø—Ä–æ–≥—Ä–∞–º—É–≤–∞–Ω–Ω—è (106)-–ì–∞–ª–∞—Ç–∞ –õ.–ü. (–ª) –ø—ñ–¥–≥—Ä—É–ø–∞ 1"
}

function getCurrentFormatedDate() {
    let now = new Date();
    let nowStr = now.getDate() + "-" + (now.getMonth() + 1) + "-" + now.getFullYear();
    return nowStr;
}

function getFormatedDate(date) {
    let now = date;
    let nowStr = now.getDate() + "-" + (now.getMonth() + 1) + "-" + now.getFullYear();
    return nowStr;
}

function sendMessageByBot(aChatId, aMessage)
{
    bot.sendMessage(aChatId, aMessage, { caption: 'I\'m a cute bot!' });
}

function sendPhotoByBot(aChatId, aPhoto) {
    bot.sendPhoto(aChatId, aPhoto);
}

bot.on('text', function(msg)
{
    var messageChatId = msg.chat.id;
    var messageText = msg.text;
    var messageDate = msg.date;
    var messageUsr = msg.from.username;

    if (messageText === '/curriculum') {
        if (curriculumObject[getCurrentFormatedDate()] != undefined) {
            sendMessageByBot(messageChatId, 'üë®‚ÄçüéìThe curriculum for todayüë©‚Äçüéì :' + "\n" + curriculumObject[getCurrentFormatedDate()]);
        } else  {
            sendMessageByBot(messageChatId, 'There is no curriculum for today! ‚úÖ');
        }
    }

    console.log(msg);
});
