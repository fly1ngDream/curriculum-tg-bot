var TelegramBot = require('node-telegram-bot-api');

const token = require('./tgapi_token');
var botOptions = {
    polling: true
};
var bot = new TelegramBot(token, botOptions);

bot.getMe().then(function(me)
{
    console.log('Hello! My name is %s!', me.first_name);
    console.log('My id is %s.', me.id);
    console.log('And my username is @%s.', me.username);
});

let curriculumObject = {
    "16-4-2019": "\n15:10 ===> \n–ü–∞—Ä–∞ 5:  –ë–∞–∑–∏ –¥–∞–Ω–∏—Ö (211)-–ö—Ä–∞—Å–Ω–æ—â–æ–∫ –í.–ú. (–õ); \n16:40 ===> \n–ü–∞—Ä–∞ 6:  –ú–µ–Ω–µ–¥–∂–º–µ–Ω—Ç –ø—Ä–æ–µ–∫—Ç—ñ–≤ –ø—Ä–æ–≥—Ä–∞–º–Ω–æ–≥–æ –∑–∞–±–µ–∑–ø–µ—á–µ–Ω–Ω—è (318)-–•–ª–µ–≤–Ω–∏–π –ê–Ω–¥—Ä—ñ–π –û–ª–µ–∫—Å–∞–Ω–¥—Ä–æ–≤–∏—á (–õ)",
    "17-4-2019": "\n13-40 ===> \n–ü–∞—Ä–∞ 4:  –Ü–Ω–∂–µ–Ω–µ—Ä—ñ—è –ø—Ä–æ–≥—Ä–∞–º–Ω–æ–≥–æ –∑–∞–±–µ–∑–ø–µ—á–µ–Ω–Ω—è (209)-–ë–æ–π–∫–æ –Æ.–ü. (–õ); \n15-10 ===> \n–ü–∞—Ä–∞ 5:  –û–±'—î–∫—Ç–Ω–æ-–æ—Ä—ñ—î–Ω—Ç–æ–≤–∞–Ω–µ –ø—Ä–æ–≥—Ä–∞–º—É–≤–∞–Ω–Ω—è (209)-–î—É—Ö–Ω–æ–≤—Å—å–∫–∞ –ö.–ö. (–õ); \n16-40 ===> \n–ü–∞—Ä–∞ 6:  –ú–µ–Ω–µ–¥–∂–º–µ–Ω—Ç –ø—Ä–æ–µ–∫—Ç—ñ–≤ –ø—Ä–æ–≥—Ä–∞–º–Ω–æ–≥–æ –∑–∞–±–µ–∑–ø–µ—á–µ–Ω–Ω—è (201)-–®–µ–ª–µ—Å—Ç –¢–µ—Ç—è–Ω–∞ –ú–∏–∫–æ–ª–∞—ó–≤–Ω–∞ (–ª) –ø—ñ–¥–≥—Ä—É–ø–∞ 2",
    "18-4-2019": "\n13-40 ===> \n–ü–∞—Ä–∞ 4:  –û–±'—î–∫—Ç–Ω–æ-–æ—Ä—ñ—î–Ω—Ç–æ–≤–∞–Ω–µ –ø—Ä–æ–≥—Ä–∞–º—É–≤–∞–Ω–Ω—è (311)-–î—É—Ö–Ω–æ–≤—Å—å–∫–∞ –ö.–ö. (–ª) –ø—ñ–¥–≥—Ä—É–ø–∞ 1; \n15-10 ===> \n15-10 ===> \n–ü–∞—Ä–∞ 5:  –û–±'—î–∫—Ç–Ω–æ-–æ—Ä—ñ—î–Ω—Ç–æ–≤–∞–Ω–µ –ø—Ä–æ–≥—Ä–∞–º—É–≤–∞–Ω–Ω—è (201)-–î—É—Ö–Ω–æ–≤—Å—å–∫–∞ –ö.–ö. (–ª) –ø—ñ–¥–≥—Ä—É–ø–∞ 2; \n15-10 ===> \n–ü–∞—Ä–∞ 5:  –ú–µ–Ω–µ–¥–∂–º–µ–Ω—Ç –ø—Ä–æ–µ–∫—Ç—ñ–≤ –ø—Ä–æ–≥—Ä–∞–º–Ω–æ–≥–æ –∑–∞–±–µ–∑–ø–µ—á–µ–Ω–Ω—è (202)-–•–ª–µ–≤–Ω–∏–π –ê–Ω–¥—Ä—ñ–π –û–ª–µ–∫—Å–∞–Ω–¥—Ä–æ–≤–∏—á (–ª) –ø—ñ–¥–≥—Ä—É–ø–∞ 1; \n16-40 ===> \n–ü–∞—Ä–∞ 6:  –Ü–Ω—Ñ–æ—Ä–º–∞—Ü—ñ–π–Ω—ñ —Å–∏—Å—Ç–µ–º–∏ —ñ —Ç–µ—Ö–Ω–æ–ª–æ–≥—ñ—ó –Ω–∞ –ø—ñ–¥–ø—Ä–∏—î–º—Å—Ç–≤–∞—Ö (209)-–ü–ª–µ—Å–∫–∞—á –í.–õ. (–õ)",
    "19-4-2019": "\n13-40 ===> \n–ü–∞—Ä–∞ 4:  –û–±'—î–∫—Ç–Ω–æ-–æ—Ä—ñ—î–Ω—Ç–æ–≤–∞–Ω–µ –ø—Ä–æ–≥—Ä–∞–º—É–≤–∞–Ω–Ω—è (202)-–î—É—Ö–Ω–æ–≤—Å—å–∫–∞ –ö.–ö. (–ª) –ø—ñ–¥–≥—Ä—É–ø–∞ 1; \n–ü–∞—Ä–∞ 4:  –ë–∞–∑–∏ –¥–∞–Ω–∏—Ö (215)-–ö—Ä–∞—Å–Ω–æ—â–æ–∫ –í.–ú. (–ª) –ø—ñ–¥–≥—Ä—É–ø–∞ 2; \n15-10 ===> \n15-10 ===> \n–ü–∞—Ä–∞ 5:  –Ü–Ω—Ñ–æ—Ä–º–∞—Ü—ñ–π–Ω—ñ —Å–∏—Å—Ç–µ–º–∏ —ñ —Ç–µ—Ö–Ω–æ–ª–æ–≥—ñ—ó –Ω–∞ –ø—ñ–¥–ø—Ä–∏—î–º—Å—Ç–≤–∞—Ö (202)-–ö—Ä–∞—Å–Ω–æ—â–æ–∫ –í.–ú. (–ª) –ø—ñ–¥–≥—Ä—É–ø–∞ 1; \n15-10 ===> \n–ü–∞—Ä–∞ 5:  –ë–µ–∑–ø–µ–∫–∞ –º–µ—Ä–µ–∂ —ñ –∫–æ–º–ø'—é—Ç–µ—Ä–Ω–∏—Ö —Å–∏—Å—Ç–µ–º (217)-–¢—ñ—Ç–æ–≤–∞ –ê.–Æ. (–ª) –ø—ñ–¥–≥—Ä—É–ø–∞ 2; \n16-40 ===> \n–ü–∞—Ä–∞ 6:  –û–±'—î–∫—Ç–Ω–æ-–æ—Ä—ñ—î–Ω—Ç–æ–≤–∞–Ω–µ –ø—Ä–æ–≥—Ä–∞–º—É–≤–∞–Ω–Ω—è (306)-–î—É—Ö–Ω–æ–≤—Å—å–∫–∞ –ö.–ö. (–ª) –ø—ñ–¥–≥—Ä—É–ø–∞ 2; \n16-40 ===> \n–ü–∞—Ä–∞ 6:  –ë–µ–∑–ø–µ–∫–∞ –º–µ—Ä–µ–∂ —ñ –∫–æ–º–ø'—é—Ç–µ—Ä–Ω–∏—Ö —Å–∏—Å—Ç–µ–º (318)-–¢—ñ—Ç–æ–≤–∞ –ê.–Æ. (–ª) –ø—ñ–¥–≥—Ä—É–ø–∞ 1",
    "23-4-2019": "\n13-40 ===> \n–ü–∞—Ä–∞ 4:  –ü—Ä–∏–∫–ª–∞–¥–Ω–µ –ø—Ä–æ–≥—Ä–∞–º–Ω–µ –∑–∞–±–µ–∑–ø–µ—á–µ–Ω–Ω—è (217)-–î–æ–º—Ä–∞—á–µ–≤ –í.–ú. (–ü); \n15-10 ===> \n–ü–∞—Ä–∞ 5:  –ë–∞–∑–∏ –¥–∞–Ω–∏—Ö (307)-–ö—Ä–∞—Å–Ω–æ—â–æ–∫ –í.–ú. (–ª) –ø—ñ–¥–≥—Ä—É–ø–∞ 1; \n15-10 ===> \n–ü–∞—Ä–∞ 5:  –ú–µ–Ω–µ–¥–∂–º–µ–Ω—Ç –ø—Ä–æ–µ–∫—Ç—ñ–≤ –ø—Ä–æ–≥—Ä–∞–º–Ω–æ–≥–æ –∑–∞–±–µ–∑–ø–µ—á–µ–Ω–Ω—è (202)-–®–µ–ª–µ—Å—Ç –¢–µ—Ç—è–Ω–∞ –ú–∏–∫–æ–ª–∞—ó–≤–Ω–∞ (–ª) –ø—ñ–¥–≥—Ä—É–ø–∞ 2; \n16-40 ===> \n–ü–∞—Ä–∞ 6:  –ú–µ–Ω–µ–¥–∂–º–µ–Ω—Ç –ø—Ä–æ–µ–∫—Ç—ñ–≤ –ø—Ä–æ–≥—Ä–∞–º–Ω–æ–≥–æ –∑–∞–±–µ–∑–ø–µ—á–µ–Ω–Ω—è (318)-–•–ª–µ–≤–Ω–∏–π –ê–Ω–¥—Ä—ñ–π –û–ª–µ–∫—Å–∞–Ω–¥—Ä–æ–≤–∏—á (–õ)",
    "24-4-2019": "\n13-40 ===> \n–ü–∞—Ä–∞ 4:  –û–±'—î–∫—Ç–Ω–æ-–æ—Ä—ñ—î–Ω—Ç–æ–≤–∞–Ω–µ –ø—Ä–æ–≥—Ä–∞–º—É–≤–∞–Ω–Ω—è (211)-–î—É—Ö–Ω–æ–≤—Å—å–∫–∞ –ö.–ö. (–õ); \n15-10 ===> \n–ü–∞—Ä–∞ 5:  –ü—Ä–∏–∫–ª–∞–¥–Ω–µ –ø—Ä–æ–≥—Ä–∞–º–Ω–µ –∑–∞–±–µ–∑–ø–µ—á–µ–Ω–Ω—è (209)-–î–æ–º—Ä–∞—á–µ–≤ –í.–ú. (–õ); \n16-40 ===> \n–ü–∞—Ä–∞ 6:  –ú–µ–Ω–µ–¥–∂–º–µ–Ω—Ç –ø—Ä–æ–µ–∫—Ç—ñ–≤ –ø—Ä–æ–≥—Ä–∞–º–Ω–æ–≥–æ –∑–∞–±–µ–∑–ø–µ—á–µ–Ω–Ω—è (208)-–•–ª–µ–≤–Ω–∏–π –ê–Ω–¥—Ä—ñ–π –û–ª–µ–∫—Å–∞–Ω–¥—Ä–æ–≤–∏—á (–ª) –ø—ñ–¥–≥—Ä—É–ø–∞ 1",
};

function getCurrentFormatedDate() {
    let now = new Date();
    let nowStr = now.getDate() + "-" + (now.getMonth() + 1) + "-" + now.getFullYear();
    return nowStr;
}

function getFormatedDate(date) {
    let now = date;
    let nowStr = now.getDate() + "-" + (now.getMonth() + 1) + "-" + now.getFullYear();
    return nowStr;
}

function sendMessageByBot(aChatId, aMessage)
{
    bot.sendMessage(aChatId, aMessage, { caption: 'I\'m a cute bot!' });
}

function sendPhotoByBot(aChatId, aPhoto) {
    bot.sendPhoto(aChatId, aPhoto);
}

bot.on('text', function(msg)
{
    var messageChatId = msg.chat.id;
    var messageText = msg.text;
    var messageDate = msg.date;
    var messageUsr = msg.from.username;

    if (messageText === '/curriculum') {
        if (curriculumObject[getCurrentFormatedDate()] != undefined) {
            sendMessageByBot(messageChatId, 'üë®‚ÄçüéìThe curriculum for todayüë©‚Äçüéì :' + "\n" + curriculumObject[getCurrentFormatedDate()]);
        } else  {
            sendMessageByBot(messageChatId, 'There is no curriculum for today! ‚úÖ');
        }
    }

    console.log(msg);
});
